# More info at: https://docs.render.com/blueprint-spec#service-fields

# all services
services:
  - name: remult-chat-svelte-summit
    type: web
    runtime: node
    # repo: https://github.com/jycouet/remult-chat-svelte-summit
    # branch: main
    region: frankfurt
    plan: free
    buildCommand: npm i -g pnpm@8.6.5; pnpm install --production=false; pnpm build
    startCommand: pnpm start
    # healthCheckPath: /api/healthz          # For 0 Downtime deploy
    # buildFilter:                           # In mono repo context, build only if some change happend
    #   paths:
    #    - apps/MY_APP/**
    #    - packages/**
    #    - render.yaml
    # domains:                               # Custom domains
    #  - example.com
    #  - www.example.org
    envVars:
      # Link one or more "env group" defined in https://dashboard.render.com/env-groups
      - fromGroup: remult-chat-svelte-summit
      # Some static envs
      - key: NODE_VERSION
        value: 18.16.0
      - key: TZ
        value: utc
      - key: NODE_ENV
        value: production
      - key: ORIGIN
        value: https://remult-chat-svelte-summit.onrender.com
      # Other Service env
      - key: DATABASE_URL
        fromDatabase:
          name: remult-chat-svelte-summit-db
          property: connectionString

# all databases
databases:
  - name: remult-chat-svelte-summit-db
    databaseName: main_db
    region: frankfurt
    plan: free
    # postgresMajorVersion: 13               # Default: most recent supported version
